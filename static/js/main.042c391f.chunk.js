(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{18:function(e,t,a){e.exports=a(35)},23:function(e,t,a){},24:function(e,t,a){},25:function(e,t,a){},26:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(15),i=a.n(c),r=(a(23),a(3)),s=a(4),l=a(7),u=a(6),h=a(8),d=a(13),m=a(5);var p=function(){function e(){Object(r.a)(this,e),this.cache={},this.useLocalStorageCache=!1}return Object(s.a)(e,[{key:"storeToCache",value:function(e,t){this.useLocalStorageCache?localStorage.setItem("query:"+e,JSON.stringify(t)):this.cache[e]=t}},{key:"restoreFromCache",value:function(e){return this.useLocalStorageCache?JSON.parse(localStorage.getItem("query:"+e)):this.cache[e]}},{key:"getLocation",value:function(e){var t="search/?query="+e;return this.sendRequest(t)}},{key:"getWeather",value:function(e,t){var a=function(e){return e.getFullYear()+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)}(new Date),n=e+("today"===t?"/"+a:"");return this.sendRequest(n)}},{key:"sendRequest",value:function(e){var t=this;return new Promise((function(a,n){var o=t.restoreFromCache(e);o?a(o):fetch("https://cors-anywhere.herokuapp.com/https://www.metaweather.com/api/location/"+e).then((function(e){return 200===e.status?e.json():{status:e.status}})).then((function(n){t.storeToCache(e,n),a(n)})).catch((function(e){console.error(e),n(e)}))}))}}]),e}(),y=(a(24),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={loading:!1,data:[]},e}return Object(h.a)(t,e),Object(s.a)(t,[{key:"getWeather",value:function(){var e=this;this.setState({loading:!0}),this.props.api.getWeather(this.props.locationID,"today").then((function(t){e.setState({loading:!1,data:t})}))}},{key:"componentDidMount",value:function(){this.getWeather()}},{key:"componentDidUpdate",value:function(e){this.props.locationID!==e.locationID&&this.getWeather()}},{key:"render",value:function(){var e=this.state.data||[],t=e[0]||{},a="https://www.metaweather.com/static/img/weather/"+t.weather_state_abbr+".svg",n=o.a.createElement("img",{src:a,alt:t.weather_state_name,className:"weatherImage",key:"wi"}),c=o.a.createElement("h1",{className:"todayTemp",key:"tt"},parseInt(t.the_temp)+"\xb0");return this.state.loading?o.a.createElement("div",{className:"state"},"Loading..."):e.length?[n,c]:o.a.createElement("div",{className:"state"},"No data")}}]),t}(o.a.Component)),g=(a(25),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={loading:!1,data:{}},e}return Object(h.a)(t,e),Object(s.a)(t,[{key:"getWeather",value:function(){var e=this;this.setState({loading:!0}),this.props.api.getWeather(this.props.locationID,"week").then((function(t){e.setState({loading:!1,data:t})}))}},{key:"componentDidMount",value:function(){this.getWeather()}},{key:"componentDidUpdate",value:function(e){this.props.locationID!==e.locationID&&this.getWeather()}},{key:"mapWeatherAbbrToRowClass",value:function(e){switch(e){case"sn":case"sl":case"h":return"snowy";case"t":case"hr":case"lr":case"s":return"rainy";case"hc":case"lc":return"cloudy";case"c":return"sunny";default:return""}}},{key:"render",value:function(){var e=this,t=this.state.data.consolidated_weather||[],a=t.map((function(t){var a="https://www.metaweather.com/static/img/weather/"+t.weather_state_abbr+".svg",n=e.mapWeatherAbbrToRowClass(t.weather_state_abbr),c=function(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()]}(function(e){var t=e.split(/\D+/);return new Date(Date.UTC(t[0],--t[1],t[2]))}(t.applicable_date));return o.a.createElement("tr",{key:t.applicable_date,className:n},o.a.createElement("td",{className:"date"},t.applicable_date,", ",c),o.a.createElement("td",null,parseInt(t.the_temp)+"\xb0"),o.a.createElement("td",{className:"weatherIcon"},o.a.createElement("img",{src:a,alt:t.weather_state_name})))}));return this.state.loading?o.a.createElement("div",{className:"state"},"Loading..."):t.length?o.a.createElement("table",{className:"week"},o.a.createElement("tbody",null,a)):o.a.createElement("div",{className:"state"},"No data")}}]),t}(o.a.Component)),f=(a(26),function(e){function t(){var e;return Object(r.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).api=new p,e.state={loading:!1,locationQuery:"Moscow",locationFound:!0,locationID:2122265},e}return Object(h.a)(t,e),Object(s.a)(t,[{key:"onLocationChange",value:function(e){var t=this;this.setState({locationQuery:e.target.value}),clearTimeout(this.timeout),this.timeout=setTimeout((function(){t.setState({loading:!0}),t.api.getLocation(t.state.locationQuery).then((function(e){var a=!!e[0],n=a?e[0].woeid:0,o=a?e[0].title:t.state.locationQuery;t.setState({loading:!1,locationQuery:o,locationFound:a,locationID:n})}))}),500)}},{key:"render",value:function(){var e=this,t=[{id:"today",label:"Today",cmp:o.a.createElement(y,{api:this.api,locationID:this.state.locationID})},{id:"week",label:"Week",cmp:o.a.createElement(g,{api:this.api,locationID:this.state.locationID})}],a=this.state.locationFound?"":"invalid";return o.a.createElement(d.a,null,o.a.createElement("input",{type:"text",className:"locationQuery "+a,value:this.state.locationQuery,onChange:function(t){return e.onLocationChange(t)},disabled:this.state.loading}),o.a.createElement("nav",null,o.a.createElement("ul",null,t.map((function(e){return o.a.createElement("li",{key:e.id},o.a.createElement(d.b,{to:"/"+e.id,activeClassName:"selected"},e.label))})))),this.state.loading?o.a.createElement("div",{className:"state"},"Loading..."):o.a.createElement(m.c,null,t.map((function(e){return o.a.createElement(m.a,{key:e.id,path:"/"+e.id},e.cmp)}))))}}]),t}(o.a.Component));i.a.render(o.a.createElement(f,null),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.042c391f.chunk.js.map